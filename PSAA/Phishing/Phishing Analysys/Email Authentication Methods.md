to check was the email realy spoofed domain/

SPF, DKIM, DMARC

### Що це за технології?

1. **SPF (Sender Policy Framework)**  
    SPF — це метод, що дозволяє домену (наприклад, `example.com`) вказати, які сервери **дозволено** надсилати листи від його імені. Це запобігає тому, щоб хтось (наприклад, хакер) підробляв ваш домен для фішингових або спам-розсилок.  
    **Простий приклад:**
    
    - Уявімо, що банк має домен `bank.com`. SPF дозволяє банку сказати: "Тільки сервери X, Y, Z можуть надсилати листи від імені `bank.com`".
    - Якщо якийсь інший сервер намагається надіслати лист від `bank.com`, він буде позначений як підозрілий.
2. **DKIM (DomainKeys Identified Mail)**  
    DKIM додає до кожного листа цифровий підпис, який можна перевірити. Цей підпис доводить, що лист дійсно було відправлено власником домену, і його вміст не було змінено в дорозі.  
    **Простий приклад:**
    
    - Листи від `bank.com` мають цифровий підпис. Коли отримувач отримує лист, він перевіряє цей підпис за допомогою спеціального ключа, збереженого у DNS-записах `bank.com`.
3. **DMARC (Domain-based Message Authentication, Reporting, and Conformance)**  
    DMARC об'єднує SPF і DKIM, щоб сказати: "Якщо SPF або DKIM не проходить, ось що треба робити з листом: позначити як спам, відхилити чи дозволити".  
    Також DMARC дозволяє домену отримувати звіти про те, хто намагається надсилати листи від його імені.
### Чому це важливо для Security Analysts?

1. **Захист від підробки домену (spoofing)**  
    Ці методи потрібні, щоб захистити компанію, клієнтів та партнерів від шахрайства.  
    Наприклад, якщо хакер підробить листи від `yourcompany.com`, люди можуть довіритись і передати їм конфіденційні дані.
    
2. **Виявлення загроз і звітність**  
    DMARC дає звіти про те, хто намагається використати ваш домен. Це допомагає аналітикам ідентифікувати можливі загрози.
    
3. **Підвищення довіри**  
    Налаштовані SPF, DKIM, DMARC покращують репутацію вашого домену. Це означає, що ваші листи з меншою ймовірністю будуть позначені як спам.

### Як перевірити ці записи на практиці?

Усі ці методи налаштовуються у DNS-записах домену. Щоб перевірити їх:

1. **SPF**  
    Використовуй команду або інструмент, щоб перевірити SPF-запис:
    
    `nslookup -type=TXT yourdomain.com` | grep -i spf
    
    У відповідь ти побачиш щось на кшталт:
    
    `"v=spf1 include:_spf.google.com ~all"`
    
    Тут:
    
    - `v=spf1` означає, що це SPF-запис.
    - `include:_spf.google.com` вказує, що дозволено сервери Google.
    - `~all` означає: всі інші сервери не дозволені.
2. **DKIM**  
    DKIM-запис теж зберігається у DNS. Для перевірки:
    
    `nslookup -type=TXT selector._domainkey.yourdomain.com`
    
    `selector` — це ім'я, яке використовується для DKIM (його дає поштовий провайдер).  
    
    У відповідь ти побачиш ключ, наприклад:
    
    `"v=DKIM1; k=rsa; p=MIGfMA0GC..."`
    
3. **DMARC**  
    DMARC-запис теж перевіряється через DNS:
    
    `nslookup -type=TXT _dmarc.yourdomain.com`
    
    У відповідь ти побачиш щось типу:
    
    `"v=DMARC1; p=reject; rua=mailto:dmarc-reports@yourdomain.com"`
    
    Тут:
    
    - `p=reject` означає: відхиляти листи, якщо SPF або DKIM не проходить.
    - `rua=mailto:dmarc-reports@yourdomain.com` — куди надсилати звіти.

### Інструменти для перевірки

- **Онлайн сервіси**:
    - [mxtoolbox.com](https://mxtoolbox.com)
    - [dmarcian.com](https://dmarcian.com)
- **Командний рядок**:  
    Використовуй `nslookup` або `dig`.