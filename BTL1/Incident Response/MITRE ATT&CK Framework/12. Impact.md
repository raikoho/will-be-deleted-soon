This lesson is going to cover the 12th stage in the MITRE ATT&CK framework, [Impact](https://attack.mitre.org/tactics/TA0040/). These techniques are used to describe the actions that adversaries may use to disrupt availability or compromise integrity by manipulating business and operational processes, such as tampering or destroying data. At the time of writing currently includes 13 top-level techniques. **We will be looking at the following:**

- [**Account Access Removal**](https://attack.mitre.org/techniques/T1531/)
- [**Defacement**](https://attack.mitre.org/techniques/T1491/) (2 sub-techniques)
- [**Data Encrypted For Impact**](https://attack.mitre.org/techniques/T1486/)

## Account Access Removal

[**MITRE Technique T1531**](https://attack.mitre.org/techniques/T1531/)

Adversaries may want to prevent access to accounts as an anti-forensic technique or simply to disrupt business operations. This can be achieved by completing any of the following:

- **Deleting Accounts**
- **Locking Accounts**
- **Changing Passwords**

From an adversaries perspective these actions are extremely noisy and Windows has a number of logs that would alert the security team to this activity, so it would likely occur once the attacker has finished all intended objectives.

Under the Procedure Examples heading we have one entry for this technique, where it was used by LockerGoga, a ransomware strain. As well as encrypting files, it also changed account passwords and logged them out so recovery of systems was even harder.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/abc59f4ac0be2f78751eb77aa625a40b023890291d133da6ffe3069ee8823b8aa14a25267f6609cac90d14e9d053.png)

For this technique the Mitigation section is extremely short because this technique is a legitimate system functionality that is being abused, and therefore there is no real way to prevent this. Administrative controls should be in place to limit the number of user accounts that have administrator or domain administrator account access and can modify or delete user accounts.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/851491ee62edde4f2d37cda2508ea728e0b7020a10b8c7e42e0c2b74fcbfb5803910597843dbe479dbf0bbb1f571.png)

MITRE offers some incredible advice for detecting this technique, and even kindly provides us with the Windows event IDs that we need to monitor. We actually covered these events in an activity within IR3) Detection and Analysis! As mentioned below, especially in larger environments, users will become locked out for legitimate reasons, such as simply forgetting their password after changing it. Events for changing or resetting a password can also legitimately be created by non-malicious users, so other methods should be considered when writing detection rules, such as event volume (1-5 login failures is likely legitimate, over 9000 is not) and comparing to a baseline of ‘standard’ activity.
  
![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/6b1f8d8add7446d0a07381910da6d4693727d05852c5c723fbe8fe69c229ce167013f24a8fe9fd65913a6145d95e.png)

## Defacement

[**MITRE Technique T1491**](https://attack.mitre.org/techniques/T1491/)

Adversaries may modify content available internally or externally to an enterprise network, such as editing desktop wallpapers to include an offensive image or ransom message, or modifying a company’s primary website reducing legitimate operation to show a public message. But why would anyone do this? It’s incredibly noisy, and if the defenders haven’t identified the malicious actor by this point, they definitely know something is wrong now. Reasons for conducting defacement actions include:

- **Delivering messaging,** typically associated with hacktivists promoting socially or politically-motivated messages
- **Intimidation,** to assist with blackmail attempts towards the compromised organisation,
- **Claiming credit for an intrusion,** potentially for socially-motivated reasons such as showing off to friends or demonstrating technical capability to the organisation and others

This technique is split into two sub-techniques, internal and external.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/ae0ae9a71685022e19e83b6fffe3f8049ed2fc1a807caeb7289030c52996ed59fb8a7f518fab9e80fa76be0a3484.png)

Arguably the easiest and most effective methods to combat internal and external defacement is to revert to the latest backup that doesn’t show any malicious modification. This is easier said than done, as efforts need to be made to protect the backups themselves too as adversaries may target these to prevent recovery. The time between the latest backup being taken and recovery being applied will result in a period of lost data, so frequent backups are essential to reduce the impact of restoration.
  
![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/ad7002678241abef3373badf00f83f27ec5cddf10078d2dafe847bcac87db3b9a9cec9d36127869fc8f68589dae6.png)

MITRE suggests that organisations monitor for changes to their website, protect the web server with a web application firewall (WAF), and filter and drop malicious traffic associated with remote-to-local (R2L) attacks including SQL injection, cross-site scripting, and others. If an attacker is able to access a web server from within the network then they may be able to circumvent the WAF by connecting directly to the system using remote tools such as Remote Desktop Protocol or Secure Shell, so file changes on the server should be monitored for unexpected changes.
  
![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/83650fba927a1cbc32d1a45d450234fa22aa3c6f7277ce8ce3a25ba0557bc6c62f058ccafda196a1e0875e737f58.png)

## Data Encryption

[**MITRE Technique T1486**](https://attack.mitre.org/techniques/T1486/)

Data encryption. What comes to mind straight away? **Ransomware.** Adversaries can work to encrypt files and data and withholding the decryption key so that there is no way of reversing the encryption. This is typically deployed to try and receive a ransom payment, at which point the adversary may or may not provide the decryption key. If the actor isn’t trying to extort money and simply wants to trash a system they can work to encrypt critical system files or the Master Boot Record to cripple system functionality. Because ransomware or encryption action will only affect the local system the adversary needs to identify ways for it to spread, such as utilising wormable vulnerabilities (WannaCry used a flaw in SMB, a file sharing protocol, that allowed it to spread rapidly) or access to [valid accounts](https://attack.mitre.org/techniques/T1078).

The Procedure Examples table has a ton of interesting entries, including some high-profile ransomware strains such as Ryuk, Shamoon, and WannaCry. We can see that they all sound similar, but if you take a deeper dive by clicking on the ransomware names you’ll find out the cool details that separate them (go on, [take a look](https://attack.mitre.org/techniques/T1486/)!)

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/b967b7936ebe9a059c6c2819f2bfebe41be20f2fe83808af7caec2b2069a12989cac37481f63fa65a624e7b38e49.png)

For the Mitigations table we’re presented with the sample suggestion as Defacement, reminding organisations to keep regular backups and ensure that they are appropriately protected to prevent tampering or destruction.
  
![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/64fc20a095adcc98b138d4522ae69f4bdaa82d8e667fe88c17339aa07e3b9e4a93f500b5e25669ae1bcde011e3ac.png)

For Detection the suggestions include monitor specific command-line usages such as vssadmin, wbadmin, bcdedit, all of which can be used to encrypt data. We can also monitor for a large number of file modifications within a short timeframe which could be evidence of ransomware actively encrypting files.
  
![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/9ca9d2be0149ce210ee7ccc1f6a1dc33e0c31b58b73875802f6a41a977d30a0dfd2d0560055709fe55217ad5b569.png)